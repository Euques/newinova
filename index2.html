<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Listagem de Eventos</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="estilo.css">
</head>
<body>
    <div class="container">
        <h2 class="mt-4">Eventos Próximos</h2>
        <div class="row" id="eventCardList">
            <!-- Os cartões de eventos serão inseridos aqui dinamicamente -->
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>

    <script>
        var firebaseConfig = {
            apiKey: "SUA_API_KEY",
            authDomain: "SEU_DOMINIO.firebaseapp.com",
            projectId: "SEU_ID_DE_PROJETO",
            storageBucket: "SEU_BUCKET.appspot.com",
            messagingSenderId: "SEU_SENDER_ID",
            appId: "SEU_APP_ID",
            measurementId: "SEU_MEASUREMENT_ID"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const eventCardList = document.getElementById("eventCardList");

        // Verifica se o usuário está autenticado.
        firebase.auth().onAuthStateChanged(function(user) {
            if (user) {
                // O usuário está autenticado.
                const cliente = "inova";
                const userID = user.uid; // Obtém o ID do usuário autenticado

                // Constrói o caminho da coleção com base no ID do usuário.
                const colecaoEventos = `${cliente}/${userID}/eventos`;

                // Agora você pode usar 'colecaoEventos' para acessar a coleção específica do usuário autenticado.
                const eventosRef = db.collection(colecaoEventos);

                // Função para listar eventos
                function listEvents() {
                    eventosRef.where("data", ">=", new Date().toISOString()).orderBy("data").get().then((querySnapshot) => {
                        eventCardList.innerHTML = "";

                        querySnapshot.forEach((doc) => {
                            const evento = doc.data();
                            const card = createEventCard(evento);
                            eventCardList.appendChild(card);
                        });
                    });
                }

                // Função para criar cartão de evento
                function createEventCard(evento) {
                    // Implemente a criação do cartão de evento conforme necessário
                    // Retorna o elemento HTML do cartão de evento
                }

                listEvents(); // Chama a função para listar eventos
            } else {
                // O usuário não está autenticado. Você pode lidar com isso de acordo com seus requisitos.
                // Por exemplo, redirecione o usuário para a página de login.
            }
        });
    </script>
</body>
</html>
